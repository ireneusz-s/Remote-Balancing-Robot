#include "IS_FIR.h"
#include <math.h>


//FIR FILTER COEFFICIENTS////////////////////////////////////////////////////////////////////////////////////////////////////
/*
 * Filter Coefficients (C Source) generated by the Filter Design and Analysis Tool
 * Generated by MATLAB(R) 9.0 and the Signal Processing Toolbox 7.2.
 * Generated on: 13-Dec-2018 18:42:13
 */

/*
 * Discrete-Time FIR Filter (real)
 * -------------------------------
 * Filter Structure  : Direct-Form FIR
 * Filter Length     : 148
 * Stable            : Yes
 * Linear Phase      : Yes (Type 2)
 */

/* General type conversion for MATLAB generated C-code  */

/* 
 * Expected path to tmwtypes.h 
 * C:\Program Files\MATLAB\R2016a\extern\include\tmwtypes.h 
 */
/*
 * Warning - Filter coefficients were truncated to fit specified data type.  
 *   The resulting response may not match generated theoretical response.
 *   Use the Filter Design & Analysis Tool to design accurate
 *   single-precision filter coefficients.
 */
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#define FILTER_TAP_NUM 148
const float filter_taps[148] = {
  0.0001260732533, 7.31686232e-05,9.392923675e-05,0.0001182480846,0.0001465514069,
  0.0001791509567,0.0002164320467,0.0002587626514,0.0003066504141,0.0003604507947,
  0.0004205648729,0.0004873752769,  0.00056152459,0.0006431788206,0.0007328180945,
  0.0008309338591,0.0009377441602, 0.001053818734, 0.001179370796, 0.001314809662,
   0.001460387371, 0.001616439084,  0.00178314338, 0.001960736234, 0.002149390988,
     0.0023492584, 0.002560375025, 0.002782853087, 0.003016583622, 0.003261574311,
   0.003517666832, 0.003784693545, 0.004062418826, 0.004350559786, 0.004648764152,
   0.004956612363, 0.005273638293, 0.005599309225, 0.005933023989,  0.00627415441,
   0.006621972192, 0.006975718774, 0.007334596012, 0.007697716355, 0.008064189926,
   0.008433046751, 0.008803303353, 0.009173918515, 0.009543833323, 0.009911951609,
    0.01027715299,  0.01063831802,  0.01099430118,  0.01134395041,  0.01168613229,
    0.01201968826,  0.01234349702,  0.01265643723,  0.01295741275,  0.01324536372,
    0.01351925358,  0.01377809979,  0.01402094495,  0.01424690615,  0.01445514057,
     0.0146448696,  0.01481538732,  0.01496604364,  0.01509626955,  0.01520556863,
    0.01529351529,  0.01535977703,  0.01540409029,  0.01542629302,  0.01542629302,
    0.01540409029,  0.01535977703,  0.01529351529,  0.01520556863,  0.01509626955,
    0.01496604364,  0.01481538732,   0.0146448696,  0.01445514057,  0.01424690615,
    0.01402094495,  0.01377809979,  0.01351925358,  0.01324536372,  0.01295741275,
    0.01265643723,  0.01234349702,  0.01201968826,  0.01168613229,  0.01134395041,
    0.01099430118,  0.01063831802,  0.01027715299, 0.009911951609, 0.009543833323,
   0.009173918515, 0.008803303353, 0.008433046751, 0.008064189926, 0.007697716355,
   0.007334596012, 0.006975718774, 0.006621972192,  0.00627415441, 0.005933023989,
   0.005599309225, 0.005273638293, 0.004956612363, 0.004648764152, 0.004350559786,
   0.004062418826, 0.003784693545, 0.003517666832, 0.003261574311, 0.003016583622,
   0.002782853087, 0.002560375025,   0.0023492584, 0.002149390988, 0.001960736234,
    0.00178314338, 0.001616439084, 0.001460387371, 0.001314809662, 0.001179370796,
   0.001053818734,0.0009377441602,0.0008309338591,0.0007328180945,0.0006431788206,
    0.00056152459,0.0004873752769,0.0004205648729,0.0003604507947,0.0003066504141,
  0.0002587626514,0.0002164320467,0.0001791509567,0.0001465514069,0.0001182480846,
  9.392923675e-05, 7.31686232e-05,0.0001260732533
};


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
float IS_FIR_calculate (float value)
{
   static float buffer[FILTER_TAP_NUM];
   float output=0;
	
   for(int i=FILTER_TAP_NUM-1;i>0;i--)
   {
       buffer[i]=buffer[i-1];
   }
   buffer[0]=value;
  
   for(int i=0;i<FILTER_TAP_NUM;i++)
   {
       output+=buffer[i]*filter_taps[i];
   }
   return output;
}

